@using AVEGIC.Entity_Models;
@model dynamic;
@{
    Layout = null;
    int i = 0, j = 0;
    int t1 = 0, cl = 0;
    bool p = false;
}
<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>PrintReport</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

    <style>
        .table1, .table1 tr, .table1 tr td {
            border-collapse: collapse;
        }

        .table1 {
            border-collapse: collapse;
            margin-bottom:2px;
        }
    </style>

    <div class="maindiv" id="invoice" style="width:100%;height:auto; background-color:#fff">
        <div class="container-fluid">
            @foreach (var models in Model.modeldynamic)
            {
                foreach (var templates in models.Value)
                {
                    foreach (var objs in templates.Key)
                    {
                        string tmp = models.Key[t1].Key;
                        <div style="@objs[0]">
                        @if (tmp[0] == 'd')
                        {
                            if (models.Key[t1].Value != "1")
                            {
                                @foreach (var dyntbl in objs[1])
                                {
                                    <table id="" class="table1" style="text-align: justify;" width="100%" cellpadding="1" cellspacing="2">
                                        @foreach (var dynrow in dyntbl)
                                        {
                                            
                                            @foreach (var dyncol in dynrow)
                                            {
                                                <tr>
                                                    @foreach (var cold in dyncol)
                                                    {
                                                    string fontsize =cold.fontsize + "px";
                                                    var height =cold.height + "em";
                                                        <td colspan="@cold.colspan" rowspan="@cold.rowspan" width="@cold.width%" valign="@cold.verticalalign" style="@cold.cellborder;border-color:@cold.cellbordercolor;visibility:@cold.printshow;height:@height;color:@cold.color;background-color:@cold.backgroundcolor; text-align:@cold.textalign;font-family:@cold.fontfamily; font-weight:@cold.fontweight;font-size:@fontsize;font-style:@cold.fontstyle">
                                                            @if (i < templates.Value.Count && j < templates.Value[i].Count)
                                                            {
                                                                @(templates.Value[i][j]?.Value ?? "")
                                                            }
                                                        </td>
                                                        j++;
                                                    }
                                                </tr>
                                            }
                                        }
                                    </table>
                                }
                            }
                            else
                            {
                                @foreach (var dyntbl in objs[1])
                                {
                                    <div style="width:100%;display:flex">
                                        @foreach (var dynrow in dyntbl)
                                        {
                                            @foreach (var dyncol in dynrow)
                                            {
                                                @foreach (var cold in dyncol)
                                                {
                                                    string fontsize = cold.fontsize + "px";
                                                    var height = cold.height + "em";
                                                    @if (i < templates.Value.Count && j < templates.Value[i].Count && templates.Value[i][j].Value != "")
                                                    {
                                                        <p style="@cold.cellborder;border-color:@cold.cellbordercolor;visibility:@cold.printshow;height:@height;width:@cold.width%;color:@cold.color;background-color:@cold.backgroundcolor; text-align:@cold.textalign;font-family:@cold.fontfamily; font-weight:@cold.fontweight;font-size:@cold.fontsize;font-size:@fontsize px;font-style:@cold.fontstyle;">
                                                            @templates.Value[i][j].Value
                                                        </p>
                                                    }
                                                    j++;
                                                }
                                            }
                                        }
                                    </div>
                                }
                            }

                            <br />
                            <br />

                            i++;
                            j = 0;
                        }
                        else
                        {
                            <table id="" class="table1" style="text-align: justify;" width="100%" cellpadding="1" cellspacing="2" bordercolor="#black">
                                <tbody>
                                        @foreach (var dyntbl in objs[1])
                                    {
                                        <tr>
                                            @foreach (var cold in dyntbl)
                                            {
                                                string fontsize =cold.fontsize + "px";
                                                if (cold.Value != cl.ToString())
                                                {
                                                    if (i < templates.Value.Count && j < templates.Value[i].Count && templates.Value[i][j].Value != "")
                                                    {
                                                        <td height="18" width="@cold.width" valign="@cold.verticalalign" style="@cold.cellborder;border-color:@cold.cellbordercolor;visibility:@cold.printshow;color:@cold.color;background-color:@cold.backgroundcolor; text-align:@cold.textalign;font-family:@cold.fontfamily; font-weight:@cold.fontweight;font-size:@fontsize px;font-style:@cold.fontstyle;font-size:@cold.fontsize">
                                                            @templates.Value[i][j].Value
                                                        </td>
                                                    }
                                                    j++;
                                                }
                                            }
                                        </tr>
                                        cl++;
                                    }
                                </tbody>
                            </table>
                            <br />
                            <br />
                            i++;
                            j = 0;
                        }
                        </div>
                        t1++;
                    }
                }
            }
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.min.js"></script>
    <script>
        $("#btnSubmit").click(function () {
            $("input[name='GridHtml']").val($("#invoice").html());
        });
    </script>
</body>
</html>
